<md-dialog ng-cloak class="dialog-min-50"><div ng-class="{'posRelative':manageShareDocumentSpinner}"><spinner name="manageShareDocumentSpinner" img-src="{{pageLoaderImg}}" show="manageShareDocumentSpinner"></spinner><form name="manageShareDocumentForm" ng-submit="saveShareDetails(manageShareDocumentForm)" novalidate="novalidate" autocomplete="off"><md-toolbar><div class="md-toolbar-tools"><div ng-if="!commentMode"><h2>{{'SHARE_RECORD'|translate}}</h2>{{topi}}</div><div ng-if="commentMode"><h2>{{'ADD_VIEW_COMMENTS'|translate}}</h2></div><span flex></span><md-button class="md-icon-button" ng-click="cancel()"><i class="fa fa-times" aria-hidden="true"></i></md-button></div></md-toolbar><md-dialog-content><div class="md-dialog-content"><md-input-container ng-show="editMode || viewMode || commentMode"><label>{{'USER_ID'|translate}}</label><input ng-model="shareDocumentDetail.userCode" name="userId" ng-disabled="true"></md-input-container><md-input-container ng-show="editMode || viewMode || commentMode"><label>{{'USER_NAME'|translate}}</label><input ng-model="shareDocumentDetail.userName" name="userName" ng-disabled="true"></md-input-container><md-input-container ng-if="intimation"><label class="md-required">{{'SELECT_ORG_LOCATION'|translate}}</label><md-select ng-model="shareDocumentDetail.orgLoc" name="orgLoc" ng-required="true"><md-option ng-repeat="orgLocationList in orgLocationLists" ng-value="{{orgLocationList}}">{{orgLocationList.value }}</md-option></md-select><div ng-messages="manageShareDocumentForm.orgLoc.$error"><div ng-message="required">{{'REQUIRED_SELECTION' |translate}}</div></div></md-input-container><md-input-container ng-if="!intimation"><label>{{'DOCUMENT_NAME'|translate}}<span class="mandatoryStar">*</span></label><input ng-model="shareDocumentDetail.sharedEntityName" name="name" ng-disabled="editMode || viewMode || commentMode" ng-readonly="true" ng-maxlength="100" required><div ng-messages="manageShareDocumentForm.name.$error"><div ng-message="required">{{'INPUT_REQ' |translate}}</div><div ng-message="maxlength">{{'MAXLENGTH_ERR' |translate}}</div></div></md-input-container><div class="margin-t-10 share-doc-component md-dialog-content-data"><md-input-container><label>{{ 'SHARE_WITH_USER' |translate}}<span class="mandatoryStar">*</span></label><input ng-model="userData.sharedWith" name="user" ng-maxlength="50" id="user" autocomplete="off" uib-typeahead="referredDataValues as referredDataValues.value for referredDataValues in getUsers($viewValue)" typeahead-min-length="3" typeahead-on-select="onUserSelect($item, $model, $label)" ng-required="true" typeahead-editable="isSubscriber" ng-disabled="editMode || viewMode || commentMode || intimation" ng-blur="validateValue(referredDataValues)" ng-pattern="/^[a-zA-Z_ 0-9]+$/"><div ng-messages="manageShareDocumentForm.user.$error"><div ng-message="required">{{'REQUIRED' |translate}}</div><div ng-message="maxlength">{{'MAX_LENGTH' |translate}}</div><div ng-message="pattern">{{'PATTERN_ERR' |translate}}</div></div></md-input-container></div><div class="margin-t-10 share-doc-component md-dialog-content-data" ng-if="userData.sharedWith && userData.sharedWith.length >= 3 && !userData.sharedWith.id && isSubscriber"><md-input-container><label ng-class="{'md-required': isSubscriber}">{{'EMAIL'|translate}}</label><input ng-model="userData.email" name="email" ng-maxlength="100" ng-pattern="/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/" ng-required="isSubscriber"><div ng-messages="manageShareDocumentForm.email.$error"><div ng-message="maxlength">{{'MAXLENGTH_ERR' |translate}}</div><div ng-message="required">{{'INPUT_REQ' |translate}}</div><div ng-message="pattern">{{'ENTER_VALID_EMAIL' |translate}}</div></div></md-input-container></div><div class="margin-t-10 share-doc-component md-dialog-content-data" ng-if="userData.sharedWith && userData.sharedWith.length >= 3 && !userData.sharedWith.id && isSubscriber"><md-input-container><label ng-class="{'md-required': isSubscriber}">{{'MOBILE_NUMBER'|translate}}</label><input ng-model="userData.mobile" name="mobile" maxlength="10" placeholder="{{'MOBILE_HINT' |translate}}" ng-pattern="/^[0-9]{10}$/" ng-required="isSubscriber"><div ng-messages="manageShareDocumentForm.mobile.$error"><div ng-message="required">{{'INPUT_REQ' |translate}}</div><div ng-message="pattern">{{'INVALID_MOBILE' |translate}}</div></div></md-input-container></div><md-input-container><label>{{ 'SHARING_VALID_TILL' |translate}}<span class="mandatoryStar">*</span></label><input datepicker class="pointer" ng-model="shareDocumentDetail.shareValidTill" from-min-date="minDate" ng-required="true" name="shareValidTill" ng-disabled="viewMode || commentMode || shareShareWith"><md-icon class="datepickerIcon"></md-icon><div ng-messages="manageShareDocumentForm.shareValidTill.$error"><div ng-message="required">{{'REQUIRED' |translate}}</div></div></md-input-container><md-radio-group ng-model="shareDocumentDetail.whetherActive" layout="row" name="whetherActive" ng-disabled="viewMode" ng-show="editMode || viewMode"><md-radio-button ng-value="true" ng-disabled="viewMode">{{'ACTIVE' | translate}}</md-radio-button><md-radio-button ng-value="false" ng-disabled="viewMode">{{'INACTIVE' | translate}}</md-radio-button></md-radio-group><ul class="share-comment-list"><li ng-repeat="shareComment in shareCommentList"><span>{{shareComment.commentBy.value}}:</span> <span>{{shareComment.createdDate| timestampToDate}}:</span> <span>{{shareComment.comment}}</span></li></ul><md-input-container ng-show="!editMode"><label>{{'COMMENTS'|translate}}</label><textarea type="text" name="comment" ng-model="shareDocumentDetail.commentText" ng-disabled="viewMode || editMode" restrict="reject"></textarea></md-input-container></div></md-dialog-content><md-dialog-actions layout="row"><span flex></span><md-button class="md-raised md-button md-ink-ripple cancel-btn" type="button" ng-click="cancel()">{{'CANCEL' | translate}}</md-button><md-button type="submit" class="md-raised md-warn margin-r-20" ng-disabled="manageShareDocumentForm.$invalid" ng-hide="viewMode">{{'SAVE' | translate}}</md-button></md-dialog-actions></form></div></md-dialog>