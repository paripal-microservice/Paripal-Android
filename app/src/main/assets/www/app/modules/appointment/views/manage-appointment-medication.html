<div class="pageTitle"><span>{{'APPOINTMENT_MEDICATION_DETAILS'|translate}}</span><help-directive help-id="USER_TEST_LIST" class="divContainer"></help-directive></div><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 panelBorder padding-t-10 margin-b-10 padding-b-10"><form name="testOrderForm" ng-cloak><div class="row"><div class="col-xs-12 col-sm-12 col-md-4 col-lg-4" ng-hide="whethersub"><md-input-container><spinner name="userNameAutoCmp" img-src="{{autoCompletLoaderImg}}" show="userNameAutoCmpLoading" is-auto-complete="true"></spinner><label>{{'USER'|translate}} <span style="color:red">*</span></label><input ng-model="userMedication.user" ng-readonly="userReadOnly" name="user" id="user" autocomplete="off" uib-typeahead="user as user.value for user in getUserNamesForRoleHistory($viewValue)" typeahead-loading="loading" typeahead-min-length="getSmartSearchMinLength('userMinLength')" required ng-disabled="viewmode ||whethersub|| editmode || hideDetailForm"><div ng-messages="medicationform.user.$error"><div ng-message="required">{{'REQUIRED' |translate}}</div><div ng-message="maxlength">{{'MAX_LENGTH' |translate}}</div><div ng-message="minlength">{{'MIN_LENGTH'|translate}}</div></div></md-input-container></div><div class="col-xs-12 col-sm-12 col-md-4 col-lg-4"><md-input-container class="md-block"><label>{{'LOCATION_RECORD_IN'|translate}}<span class="mandatoryStar">*</span></label><input type="text" required ng-blur="validate(userMedication.creatingOrgn,medicationSideEffectForm.creatingOrganizationId)" name="creatingOrganizationId" id="creatingOrganizationId" ng-model="userMedication.creatingOrganizationId" ng-disabled="viewmode || editmode ||whethersub || hideDetailForm" required autocomplete="off" uib-typeahead="orgLocationCode as orgLocationCode.value for orgLocationCode in getCreatedBy($viewValue)" typeahead-loading="loading" typeahead-min-length="getSmartSearchMinLength('orgMinLength')" typeahead-on-select="getDoctor(userMedication.creatingOrganizationId.id)"><div ng-messages="medicationform.creatingOrganizationId.$error"><div ng-message="required">{{'REQUIRED_SELECTION' |translate}}</div><div ng-message="maxlength">{{'MAX_LENGTH' |translate}}</div></div></md-input-container></div><div class="col-sm-12 col-md-4 col-lg-4"><md-input-container class="md-block"><label>{{'ORGNL_PRES_BY'|translate}}<span class="mandatoryStar">*</span></label><input type="text" required ng-disabled="viewmode" ng-model="userMedication.prescribedOriginallyBy" name="prescribedOriginallyBy" ng-required="!viewMode" autocomplete="off" uib-typeahead="prescribedOriginallyBy as prescribedOriginallyBy.value for prescribedOriginallyBy in getDoctor($viewValue)" typeahead-min-length="getSmartSearchMinLength('defaultMinLength')"><div ng-messages="medicationform.prescribedOriginallyBy.$error"><div ng-message="required">{{'REQUIRED_SELECTION' |translate}}</div><div ng-message="maxlength">{{'MAX_LENGTH' |translate}}</div></div></md-input-container></div></div><div class="row"><div class="col-sm-12 col-md-4 col-lg-4"><md-input-container class="md-block"><label>{{'CRNT_PRES_FROM'|translate}}<span class="mandatoryStar">*</span></label><input type="text" required ng-disabled="viewmode" name="currentPrescriptionFrom" ng-model="userMedication.currentPrescriptionFrom" ng-value="currentPrescriptionFrom" ng-required="!viewMode" autocomplete="off" uib-typeahead="currentPrescriptionFrom as currentPrescriptionFrom.value for currentPrescriptionFrom in getDoctor($viewValue)" typeahead-min-length="getSmartSearchMinLength('defaultMinLength')"><div ng-messages="medicationform.currentPrescriptionFrom.$error"><div ng-message="required">{{'REQUIRED_SELECTION' |translate}}</div><div ng-message="maxlength">{{'MAX_LENGTH' |translate}}</div></div></md-input-container></div></div><div class="row margin-t-10"><h4 class="col-lg-2 col-md-2 col-sm-6 col-xs-6 margin-t-10">{{'ADD_MEDICATION' | translate}}</h4><div class="padding-l-0"><md-button class="md-raised md-warn md-button md-ink-ripple fa fa-plus availability-add-btn" ng-disabled="$next || pageState == 'view'" ng-click="addTest()" style="float: left"></md-button></div></div><div class="repeatDiv appt-medication-card" ng-repeat="test in testItArray" ng-hide="test.whetherDeleted==true"><div class="row"><div class="col-sm-10 col-md-3 col-lg-3 col-xs-10 margin-t-10"><md-input-container class="md-block"><spinner name="userNameAutoCmp" img-src="{{autoCompletLoaderImg}}" show="medicationLoad" is-auto-complete="true"></spinner><label>{{'MEDICATION'|translate}}<span class="mandatoryStar">*</span></label><input type="text" ng-blur="validate(medication,addUserMedication.medication)" name="medication" id="medication" ng-model="test.medication" autocomplete="off" uib-typeahead="medication as medication.value for medication in getMedications($viewValue)" typeahead-on-select="getVariant(test.medication.id,test)" typeahead-loading="loading" typeahead-min-length="getSmartSearchMinLength(medicationMinLength)" required ng-disabled="viewmode || test.id "><div ng-messages="medicationform.user.$error"><div ng-message="required">{{'REQUIRED' |translate}}</div></div></md-input-container></div><div class="col-sm-10 col-md-3 col-lg-3 col-xs-10 margin-t-10"><md-input-container class="md-block"><label class="md-required">{{'DRUG_VARIANT'|translate}}</label><md-select ng-change="validateMedicationVariant(test.medicationVariant,test)" ng-model="test.medicationVariant" name="medicationVariant" id="medicationVariant" ng-disabled="disabled || variantDisable || viewmode || test.id" required><md-option ng-repeat="drugs in test.medicationVariantList" ng-value="drugs" ng-selected="{{drugs.id==test.medicationVariant.id||drugs.id == drugVariantId}}">{{drugs.value}}</md-option></md-select><div ng-messages="medicationform.medicationVariant.$error "><div ng-message="required">{{'REQUIRED_SELECTION' |translate}}</div><div ng-message="maxlength">{{'MAX_LENGTH' |translate}}</div></div></md-input-container></div><div class="col-sm-10 col-md-3 col-lg-3 col-xs-10 margin-t-10"><md-input-container class="md-block"><label>{{'DOSAGE'|translate}}<span class="mandatoryStar">*</span></label><input type="text" required name="dosage" id="dosage" ng-model="test.dosage" ng-disabled="viewmode"><div ng-messages="medicationform.dosage.$error"><div ng-message="required">{{'REQUIRED' |translate}}</div><div ng-message="maxlength">{{'MAX_LENGTH' |translate}}</div><div ng-message="minlength">{{'MIN_LENGTH'|translate}}</div></div></md-input-container></div><div class="col-sm-10 col-md-3 col-lg-3 col-xs-10 margin-t-10"><md-input-container class="md-block"><label>{{'PATTERN'|translate}}<span class="mandatoryStar">*</span></label><input type="text" ng-model="test.dosagePattern" name="dosagePattern" id="dosagePattern" ng-disabled="viewmode" required><div ng-messages="medicationform.dosagePattern.$error"><div ng-message="required">{{'REQUIRED' |translate}}</div><div ng-message="maxlength">{{'MAX_LENGTH' |translate}}</div><div ng-message="minlength">{{'MIN_LENGTH'|translate}}</div></div></md-input-container></div></div><div class="row"><div class="col-sm-10 col-md-3 col-lg-3 col-xs-10 margin-t-10"><md-input-container><label>{{'START_ON'|translate}}<span class="mandatoryStar">*</span></label><input datepicker class="pointer" ng-disabled="viewmode" id="startDate" ng-change="getDate(userMedication.startDate)" ng-model="test.startDate" from-min-date="test.validFromDate" name="startDate" required><md-icon class="datepickerIcon"></md-icon><div ng-messages="medicationform.startDate.$error"><div ng-message="required">{{'REQUIRED' |translate}}</div></div></md-input-container></div><div class="col-sm-10 col-md-3 col-lg-3 col-xs-10 margin-t-10"><md-input-container class="md-block"><label>{{'DISEASE_VARIANT'|translate}}<span style="color:red">*</span></label><input type="text" name="diseaseVariant" ng-disabled="viewmode || (editmode && test.id)" required ng-model="test.diseaseVariant" typeahead-on-select="getDisease(test.diseaseVariant.id,test)" ng-disabled="viewmode" autocomplete="off" uib-typeahead="diseaseVariant as diseaseVariant.value for diseaseVariant in getDiseaseVariant($viewValue)" typeahead-loading="loading" typeahead-min-length="getSmartSearchMinLength('diseaseVariantMinLength')" required><div ng-messages="medicationform.diseaseVariant.$error"><div ng-message="required">{{'REQUIRED' |translate}}</div><div ng-message="maxlength">{{'MAX_LENGTH' |translate}}</div></div></md-input-container></div><div class="col-sm-10 col-md-3 col-lg-3 col-xs-10 margin-t-10"><md-input-container class="md-block"><label>{{'LNK_TO_FOOD'|translate}}<span class="mandatoryStar">*</span></label><md-select name="linkageWithFood" id="linkageWithFood" ng-model="test.linkageWithFood" ng-disabled="viewmode" required><md-option ng-repeat="foodLink in linkageWithFood" ng-value="foodLink" ng-selected="{{foodLink.id == test.linkageWithFood.id}}">{{foodLink.value}}</md-option></md-select><div ng-messages="medicationform.linkageWithFood.$error"><div ng-message="required">{{'REQUIRED_SELECTION' |translate}}</div><div ng-message="maxlength">{{'MAX_LENGTH' |translate}}</div></div></md-input-container></div><custom-number-field css-class="col-xs-12 col-md-1 col-lg-1 padding-t-10" label-name="QUANTITY" model-name="test.quantity" regex="^(?!(0))[0-9]{1,15}$" disable="pageState==='VIEW' || test.whetherBilled==true" required="true" change-method=""></custom-number-field><div class="col-xs-12 col-md-2 col-lg-2 padding-t-15" ng-if="!showQuantity"><md-input-container><label class="displayBlock" style="padding-left: 30px;padding-bottom: 5px">{{'ORDER_WITH_US'|translate}}</label><md-checkbox ng-model="test.orderWithUs" aria-label="Monday" ng-required="requiredValue" ng-disabled="linkMode || fromLocWall || test.whetherBilled==true || test.medicationVariant.whetherAvailable==false"></md-checkbox></md-input-container></div></div><div class="row"><md-button class="md-raised md-warn availability-remove-btn fa fa-minus margin-l-20" ng-click="removeTest($index)" style="float: left; margin-top: 10px" ng-disabled="pageState == 'view' || test.whetherBilled==true"></md-button></div></div><div class="col-sm-12 col-md-12 col-lg-12 padding-t-b-10 wizardFooter"><div class="col-xs-8 col-sm-8 col-md-12 col-lg-12 padding-0 textAlign-C"><md-button class="md-raised" ng-click="cancel()">{{'CANCEL'|translate}}</md-button><md-button ng-if="showTestBtn!=true" class="md-raised md-warn" ng-disabled="!testOrderForm.$valid || pageState == 'view' || viewmode" ng-click="saveUserMedication()">{{'SAVE'|translate}}</md-button></div></div></form></div><script src="components/js/custom/custom.js"></script>