!function(e,t,i){"use strict";function n(e){return e<10?"0"+String(e):String(e)}t.module("md.time.picker",["ngMessages"]).directive("mdHoursMinutes",function(){return{restrict:"E",scope:{type:"@",message:"@",ngModel:"="},template:'<md-input-container md-no-float><input ng-required="mandatory" type="text"name="time_{{type}}"ng-model="time[type]"ng-change="handleInput()"placeholder="{{type}}"maxlength="2"ng-blur="handleInput(true)"ng-keydown="handleKeypress($event)" ng-disabled="readOnly"/><span class="md-up-arrow" aria-hidden="true" ng-click="!readOnly && increase()"></span><span class="md-down-arrow" aria-hidden="true" ng-click="!readOnly && decrease()"></span><div class="time-error-messages" ng-messages="$parent.timeForm[\'time_\' + type].$error" role="alert"><div ng-message="required">{{message}}</div></div></md-input-container>',controller:["$scope","$rootScope",function(e,i){function r(){if("HH"===e.type){var t="";try{t=e.$parent.ngModel.getHours()}catch(e){}e.$parent.noMeridiem||(t>12?t-=12:0===t&&(t+=12)),e.time.HH=String(t)}else e.$parent.ngModel?e.time.MM=n(e.$parent.ngModel.getMinutes()):e.time.MM=""}"HH"===e.type?e.$parent.noMeridiem?(e.min=0,e.max=23):(e.min=1,e.max=12):(e.min=0,e.max=59),e.time={},e.$watch("ngModel",function(){r()});var o=e.$on("mdpTimePickerModalUpdated",r);function s(i){if(!isNaN(i))if(t.isDate(e.ngModel)?isNaN(e.ngModel.getTime())&&(e.ngModel=new Date(2017,0,0,0,0,0,0)):e.ngModel=new Date(2017,0,0,0,0,0,0),"MM"!==e.type){if(!e.$parent.noMeridiem){var n=e.ngModel.getHours();n>=12&&12!=i?i+=12:n<12&&12==i&&(i=0)}e.ngModel.setHours(i)}else e.ngModel.setMinutes(i)}e.$on("$destroy",o),e.increase=function(){var t,r,o,a,m,c=(t=e.time[e.type],r=e.min,o=e.max,a=e.type,m=parseInt(t),isNaN(m)||m===o?m=r:m++,"MM"===a?n(m):String(m));e.time[e.type]=c,s(parseInt(c)),i.$emit("mdpTimePickerUpdated")},e.decrease=function(){var t,r,o,a,m,c=(t=e.time[e.type],r=e.min,o=e.max,a=e.type,m=parseInt(t),isNaN(m)||m===r?m=o:m--,"MM"===a?n(m):String(m));e.time[e.type]=c,s(parseInt(c)),i.$emit("mdpTimePickerUpdated")},e.handleInput=function(t){var r=function(e,t,i,r){var o=parseInt(e);return"HH"===r&&0===o?0===o?String(o):void 0:o>t?String(o)[0]:isNaN(o)?void 0:2===e.length||i&&"MM"===r?n(o):String(o)}(e.time[e.type],e.max,t,e.type);e.time[e.type]=r,s(parseInt(r)),i.$emit("mdpTimePickerUpdated")},e.handleKeypress=function(t){38===t.keyCode?e.increase():40===t.keyCode&&e.decrease()}}]}}).directive("mdMeridiem",function(){return{restrict:"E",scope:{message:"@",ngModel:"="},template:'<md-input-container md-no-float><md-select ng-required="mandatory" name="meridiem"ng-model="meridiem"ng-change="updateTime()"placeholder="AM/PM"flex-gt-sm ng-disabled="readOnly"><md-option value="AM" ng-disabled="readOnly">AM</md-option><md-option value="PM" ng-disabled="readOnly">PM</md-option></md-select><div class="time-error-messages" ng-messages="$parent.timeForm.meridiem.$error" role="alert"><div ng-message="required">{{message}}</div></div></md-input-container>',controller:["$scope","$rootScope",function(e,t){function i(){var t="";try{t=e.$parent.$parent.ngModel.getHours()}catch(e){}e.meridiem=t>=0&&t<12?"AM":"PM"}e.$watch("ngModel",function(){i()}),e.updateTime=function(){var i=e.$parent.$parent.ngModel.getHours();"AM"===e.meridiem?e.$parent.$parent.ngModel.setHours(i-12):e.$parent.$parent.ngModel.setHours(i+12),t.$emit("mdpTimePickerUpdated")};var n=e.$on("mdpTimePickerModalUpdated",i);e.$on("$destroy",n)}]}}).directive("mdTimePicker",function(){return{restrict:"E",scope:{ngModel:"="},template:'<ng-form name="timeForm"><button class="md-raised md-warn md-button md-ink-ripple" style="min-width:0%" type="button" ng-click="!readOnly && showPicker($event)" ng-disabled="readOnly"><md-icon><i class="material-icons">&#xE192;</i></md-icon><div class="md-ripple-container"></div></button><md-hours-minutes type="HH" ng-model="ngModel" message="{{message.hour}}" read-only="readOnly" mandatory="mandatory"></md-hours-minutes><span class="time-colon">:</span><md-hours-minutes type="MM" ng-model="ngModel" message="{{message.minute}}" read-only="readOnly" mandatory="mandatory"></md-hours-minutes><md-meridiem ng-if="!noMeridiem" ng-model="ngModel" message="{{message.meridiem}}" read-only="readOnly" mandatory="mandatory"></md-meridiem></ng-form>',controller:["$scope","$rootScope","$mdpTimePicker","$attrs",function(e,i,n,r){e.showPicker=function(r){n(e.ngModel,{targetEvent:r,noMeridiem:e.noMeridiem,autoSwitch:!e.noAutoSwitch}).then(function(n){t.isDate(e.ngModel)?isNaN(e.ngModel.getTime())&&(e.ngModel=new Date(2017,0,0,0,0,0,0)):e.ngModel=new Date(2017,0,0,0,0,0,0),n&&n.getHours()&&e.ngModel.setHours(n.getHours()),n&&n.getMinutes()&&e.ngModel.setMinutes(n.getMinutes()),e.$broadcast("mdpTimePickerModalUpdated"),i.$emit("mdpTimePickerUpdated")})}}],compile:function(e,t){return{pre:function(e){e.noMeridiem=""===t.noMeridiem,e.noAutoSwitch=""===t.noAutoSwitch}}}}}).provider("$mdpTimePicker",function(){var e="OK",i="Cancel";this.setOKButtonLabel=function(t){e=t},this.setCancelButtonLabel=function(e){i=e},this.$get=["$mdDialog",function(r){return function(o,s){return r.show({controller:["$scope","$mdDialog","$mdMedia","$rootScope",function(e,i,r,a){var m=this;t.isDate(o)?isNaN(o.getTime())&&(o=new Date(2017,0,0,0,0,0,0)):o=new Date(2017,0,0,0,0,0,0),this.time=new Date(o.getTime()),this.noMeridiem=s.noMeridiem,m.noMeridiem||(this.meridiem=o.getHours()<12?"AM":"PM"),this.VIEW_HOURS=1,this.VIEW_MINUTES=2,this.currentView=this.VIEW_HOURS,this.autoSwitch=!!s.autoSwitch,e.$mdMedia=r,this.switchView=function(){m.currentView=m.currentView==m.VIEW_HOURS?m.VIEW_MINUTES:m.VIEW_HOURS},this.hours=function(){var e=m.time.getHours();return m.noMeridiem?e:e>12?e-12:0===e?12:e},this.minutes=function(){return n(m.time.getMinutes())},this.setAM=function(){var e=m.time.getHours();e>=12&&(m.time.setHours(e-12),m.meridiem="AM")},this.setPM=function(){var e=m.time.getHours();e<12&&(m.time.setHours(e+12),m.meridiem="PM")},this.cancel=function(){i.hide()},this.confirm=function(){i.hide(this.time),a.$broadcast("medicationTime",this.time)}}],controllerAs:"timepicker",clickOutsideToClose:!1,template:'<md-dialog aria-label="" class="mdp-timepicker" ng-class="{ \'portrait\': !$mdMedia(\'gt-xs\') }"><md-dialog-content layout-gt-xs="row" layout-wrap><md-toolbar layout-gt-xs="column" layout-xs="row" layout-align="center center" flex class="mdp-timepicker-time md-hue-1 md-primary"><div class="mdp-timepicker-selected-time"><span ng-class="{ \'active\': timepicker.currentView == timepicker.VIEW_HOURS }" ng-click="timepicker.currentView = timepicker.VIEW_HOURS">{{ timepicker.hours() }}</span>:<span ng-class="{ \'active\': timepicker.currentView == timepicker.VIEW_MINUTES }" ng-click="timepicker.currentView = timepicker.VIEW_MINUTES">{{ timepicker.minutes() }}</span></div><div layout="column" class="mdp-timepicker-selected-ampm"><span ng-if="timepicker.meridiem" ng-click="timepicker.setAM()" ng-class="{ \'active\': timepicker.meridiem === \'AM\' }">AM</span><span ng-if="timepicker.meridiem" ng-click="timepicker.setPM()" ng-class="{ \'active\': timepicker.meridiem === \'PM\' }">PM</span></div></md-toolbar><div><div class="mdp-clock-switch-container" ng-switch="timepicker.currentView" layout layout-align="center center"><mdp-clock class="mdp-animation-zoom" auto-switch="timepicker.autoSwitch" time="timepicker.time" no-meridiem="noMeridiem" type="hours" ng-switch-when="1"></mdp-clock><mdp-clock class="mdp-animation-zoom" auto-switch="timepicker.autoSwitch" time="timepicker.time" type="minutes" ng-switch-when="2"></mdp-clock></div><md-dialog-actions layout="row"><span flex></span><md-button ng-click="timepicker.cancel()" aria-label="'+i+'">'+i+'</md-button><md-button ng-click="timepicker.confirm()" class="md-primary" aria-label="'+e+'">'+e+"</md-button></md-dialog-actions></div></md-dialog-content></md-dialog>",targetEvent:s.targetEvent,locals:{time:o,noMeridiem:s.noMeridiem,autoSwitch:s.autoSwitch},skipHide:!0,multiple:!0})}}]}).directive("mdpClock",["$animate","$timeout",function(e,i){return{restrict:"E",bindToController:{type:"@?",time:"=",autoSwitch:"=?"},replace:!0,template:'<div class="mdp-clock"><div class="mdp-clock-container"><md-toolbar class="mdp-clock-center md-primary"></md-toolbar><md-toolbar ng-style="clock.getPointerStyle()" class="mdp-pointer md-primary"><span class="mdp-clock-selected md-button md-raised md-primary"></span></md-toolbar><md-button ng-if="clock.type === \'minutes\'" ng-class="{ \'md-primary\': clock.selected == step }" class="md-icon-button md-raised mdp-clock-deg{{ ::(clock.STEP_DEG_MINUTES * ($index + 1)) }}" ng-repeat="step in clock.steps">{{ step }}</md-button><md-button ng-if="clock.type !== \'minutes\'" ng-class="{ \'md-primary\': clock.selected == step }" class="md-icon-button md-raised mdp-clock-deg{{ ::(clock.STEP_DEG * ($index + 1)) }}" ng-repeat="step in clock.steps">{{ step }}</md-button></div></div>',controller:["$scope",function(e){var i=this;this.noMeridiem=e.$parent.timepicker.noMeridiem,this.STEP_DEG=this.noMeridiem?15:30,this.STEP_DEG_MINUTES=30,this.steps=[],this.CLOCK_TYPES={hours:{range:this.noMeridiem?24:12},minutes:{range:60}},this.getPointerStyle=function(){var e=1;switch(i.type){case"hours":e=i.noMeridiem?24:12;break;case"minutes":e=60}var t=Math.round(i.selected*(360/e))-180;return{"-webkit-transform":"rotate("+t+"deg)","-ms-transform":"rotate("+t+"deg)",transform:"rotate("+t+"deg)"}},this.setTimeByDeg=function(e){var t=0;switch(i.type){case"hours":t=i.noMeridiem?24:12;break;case"minutes":t=60}var n=Math.round(t/360*e);i.noMeridiem||"hours"!==i.type||0!==n?"minutes"===i.type&&60===n&&(n=0):n=12,i.setTime(n)},this.setTime=function(e){switch(this.selected=e,i.type){case"hours":if(!i.noMeridiem){var t=this.time.getHours()>=12;t&&12!=e?e+=12:t||12!==e||(e=0)}this.time.setHours(e);break;case"minutes":this.time.setMinutes(e)}},this.$onInit=function(){switch(i.type=i.type||"hours",i.type){case"hours":if(i.noMeridiem){for(var e=1;e<=23;e++)i.steps.push(e);i.steps.push(0),i.selected=i.time.getHours()||0}else{for(e=1;e<=12;e++)i.steps.push(e);i.selected=i.time.getHours()||0,i.selected>12&&(i.selected-=12)}break;case"minutes":for(e=5;e<=55;e+=5)i.steps.push(e);i.steps.push(0),i.selected=i.time.getMinutes()||0}},1===t.version.major&&t.version.minor<5&&this.$onInit()}],controllerAs:"clock",link:function(e,n,r,o){t.element(n[0].querySelector(".mdp-pointer"));var s=e.$parent.timepicker,a=function(e){var t=e.currentTarget.getClientRects()[0],n=e.currentTarget.offsetWidth/2-(e.pageX-t.left),r=e.pageY-t.top-e.currentTarget.offsetHeight/2,a=Math.round(Math.atan2(n,r)*(180/Math.PI));i(function(){o.setTimeByDeg(a+180),"hours"===o.type&&o.autoSwitch&&s.switchView()})};n.on("click",a),e.$on("$destroy",function(){n.off("click",a)})}}}])}(window,angular);
